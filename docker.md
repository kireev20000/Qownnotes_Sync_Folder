# Docker

docker run -t -d -p 9980:9980 -e "extra_params=--o:ssl.enable=false" collabora/code:22.05.10.2.1


–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.
```
docker cp <containerId>:/file/path/within/container /host/path/target
docker cp d537be3137f859effa67dde813d34a5a12a6e6c6190510f6c322bca6bcf5972f://etc/coolwsd/coolwsd.xml b:/coolwsd.xml
```
–ø—Ä–æ–ø–∏—Å—å –ø—É—Ç–µ–π –¥–ª—è –≤–∏–Ω–¥—ã 0
```
    volumes:
      - "B:/_WorkLab/_other/colla_lab_example/flask_collabora/pyscripts:/opt/collaboraoffice/share/Scripts/python"
```
–≤—ã–ø–æ–ª–Ω–∏ –∫–æ–º–∞–Ω–¥—É sudo docker exec -it -u=root –∏–º—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ /bin/bash (–≤ –≤–∏–Ω–¥–µ –±–µ–∑ —Å—É–¥–æ)
sudo apt install inetutils-ping - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∏–Ω–≥–∞ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä 
apt install mc - midnight commander

—Å–æ–±—Ä–∞—Ç—å —Ñ–∞–π–ª
```
docker build -t image_name .
```
## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞ production
### –°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```
git clone 
```
- –°–æ–±–µ—Ä–∏—Ç–µ –¥–æ–∫–µ—Ä-–æ–±—Ä–∞–∑ –∏–∑ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:***
```shell
docker build -t flask_test_case .
```

- C–æ–∑–¥–∞—Ç—å –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å .env —Ñ–∞–π–ª –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ infra
```
FLASK_APP=app
FLASK_DEBUG=False
SECRET_KEY_JWT='–≤–∞—à —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á'
DATABASE_URL ='postgresql://postgres:postgres@db:5432/maindb'
COMPOSE_PROJECT_NAME="test_case_rg"
```

- –ó–∞–ø—É—Å–∫–∞–µ–º docker-compose –∏–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ infra:
```shell
docker compose -f docker-compose.production.yml up
```

–ò–º—è —Ö–æ—Å—Ç–∞ –≤ PGAdmine db, –∞ –Ω–µ –ª–æ–∫–∞–ª—Ö–æ—Å—Ç –∏ —Ç.–¥.

docker compose -f docker-compose.production.yml up 



## –ß—Ç–æ —Ç–∞–∫–æ–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è? –ó–∞—á–µ–º –æ–Ω–∞ –Ω—É–∂–Ω–∞?
–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è ‚Äî —ç—Ç–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–≥–∞–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã. –ü—Ä–æ–≥—Ä–∞–º–º–∞ —É–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –æ–±–æ–ª–æ—á–∫—É-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –≤–Ω—É—Ç—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π ‚Äî —Å—Ä–µ–¥–∞, –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –¥–ª—è —Ä–∞–±–æ—Ç—ã.

–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è –Ω—É–∂–Ω–∞ –¥–ª—è:

1. –¥–ª—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ —Ä–∞–±–æ—á–∏—Ö —Å—Ä–µ–¥ –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏—Å—Ç–µ–º—ã –∏ –ü–û, —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –º–∞—à–∏–Ω–µ;
2. –∫–æ–Ω—Ç—Ä–æ–ª—è —Ä–µ—Å—É—Ä—Å–æ–≤ –∏ —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ —Å–∏—Å—Ç–µ–º—É;
3. —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –∏–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ —Ä–∞–∑–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω—É–∂–¥–∞—é—Ç—Å—è –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–µ—Ä—Å–∏—è—Ö –ü–û –∏–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫;
4. –±—ã—Å—Ç—Ä–æ–≥–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ —Å—Ä–µ–¥ —Å –æ–¥–Ω–æ–π –º–∞—à–∏–Ω—ã –Ω–∞ –¥—Ä—É–≥—É—é;
5. —Å–æ–∑–¥–∞–Ω–∏—è —É–¥–æ–±–Ω–æ–π —Ä–∞–±–æ—á–µ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã;
6. —É—Å–∫–æ—Ä–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Å–Ω–∏–∂–µ–Ω–∏—è —Ä–∏—Å–∫–∞ –æ—à–∏–±–æ–∫;
7. –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –≥–æ—Ç–æ–≤—ã—Ö —Ä–µ—à–µ–Ω–∏–π;
8. –ª–µ–≥–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ª–æ–∂–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏, —Å—Ä–µ–¥–∞–º–∏ –∏ —Å–∏—Å—Ç–µ–º–∞–º–∏. 

## –ß–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã?
–û—Å–Ω–æ–≤–Ω–æ–µ —Ä–∞–∑–ª–∏—á–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö –º–∞—à–∏–Ω –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∏—Ä—É—é—Ç –≤–µ—Å—å –∫–æ–º–ø—å—é—Ç–µ—Ä –≤–ø–ª–æ—Ç—å –¥–æ –∞–ø–ø–∞—Ä–∞—Ç–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π, –∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –≤—ã—à–µ —É—Ä–æ–≤–Ω—è –æ–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã.

## –ß—Ç–æ —Ç–∞–∫–æ–µ –æ–±—Ä–∞–∑?
Image. –ù–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π —Ñ–∞–π–ª (–æ–±—Ä–∞–∑), –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –º–æ–∂–Ω–æ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

–û–±—Ä–∞–∑ Docker (Docker Image) - —ç—Ç–æ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π —Ñ–∞–π–ª, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥, –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –¥—Ä—É–≥–∏–µ —Ñ–∞–π–ª—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–ò–∑-–∑–∞ —Ç–æ–≥–æ, —á—Ç–æ –æ–±—Ä–∞–∑—ã –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è –∏—Ö –∏–Ω–æ–≥–¥–∞ –Ω–∞–∑—ã–≤–∞—é—Ç —Å–Ω–∏–º–∫–∞–º–∏ (snapshot).–û–Ω–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –µ–≥–æ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é —Å—Ä–µ–¥—É –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏. –¢–∞–∫–∞—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —è–≤–ª—è–µ—Ç—Å—è –æ–¥–Ω–æ–π –∏–∑ –æ—Ç–ª–∏—á–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π Docker. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –≤ —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö, –æ–¥–Ω–æ—Ä–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö.

## –ß—Ç–æ —Ç–∞–∫–æ–µ —Ç–æ–º?
–¢–æ–º Docker ‚Äî —ç—Ç–æ —Å—Ä–µ–¥—Å—Ç–≤–æ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ. –î–∞–Ω–Ω—ã–µ –≤ —Ç–æ–º–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤. –ï—Å–ª–∏ –≤—ã —É–¥–∞–ª–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, —Ç–æ–º–∞ –∏ –¥–∞–Ω–Ω—ã–µ –≤ —Ç–æ–º–∞—Ö –æ—Å—Ç–∞–Ω—É—Ç—Å—è. –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–º–∞ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è.

–¢–æ–º–∞ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤ Docker –ø–∞–ø–∫–∏ —Ö—Ä–∞–Ω–∏–ª–∏—â —Å–æ–∑–¥–∞—é—Ç—Å—è –Ω–∞ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω–µ, –Ω–æ –ø—Ä–µ–¥—É—Å–º–æ—Ç—Ä–µ–Ω–∞ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —É–¥–∞–ª–µ–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â

## –ß—Ç–æ —Ç–∞–∫–æ–µ —Å–µ—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞?
–°–µ—Ç—å Docker –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ Docker –∏ –≤–Ω–µ—à–Ω–∏–º –º–∏—Ä–æ–º —á–µ—Ä–µ–∑ —Ö–æ—Å—Ç-–º–∞—à–∏–Ω—É, –∏–ª–∏ –≤—ã –º–æ–∂–µ—Ç–µ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —ç—Ç–æ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–∞–Ω–∞–ª, —á–µ—Ä–µ–∑ –∫–æ—Ç–æ—Ä—ã–π –≤—Å–µ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤—É—é—Ç –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.

## –ö–∞–∫–∏–µ –≤–∏–¥—ã —Å–µ—Ç–µ–π –±—ã–≤–∞—é—Ç?

1. Bridge network –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å–µ—Ç—å —Ç–∏–ø–∞ –º–æ—Å—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ù–µ–¥–∞–≤–Ω–æ –∑–∞–ø—É—â–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ –Ω–µ–º—É. –í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –º–æ—Å—Ç–æ–≤—ã–µ —Å–µ—Ç–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –º–æ—Å—Ç–æ–≤—ã–µ —Å–µ—Ç–∏ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è—Ç —Å–µ—Ç–µ–≤—ã–µ –º–æ—Å—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
2. Host network : —É–¥–∞–ª—è–µ—Ç —Å–µ—Ç–µ–≤—É—é –∏–∑–æ–ª—è—Ü–∏—é –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –∏ —Ö–æ—Å—Ç–æ–º Docker –∏ –Ω–∞–ø—Ä—è–º—É—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ—Ç—å —Ö–æ—Å—Ç–∞. –ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ –ø–æ—Ä—Ç—É 80, –∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Ö–æ—Å—Ç-—Å–µ—Ç—å, –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω–æ —á–µ—Ä–µ–∑ –ø–æ—Ä—Ç 80 –ø–æ IP-–∞–¥—Ä–µ—Å—É —Ö–æ—Å—Ç–∞. –û–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤—ã –Ω–µ —Å–º–æ–∂–µ—Ç–µ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ–±-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –Ω–∞ –æ–¥–Ω–æ–º —Ö–æ—Å—Ç–µ, –Ω–∞ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –ø–æ—Ä—Ç—É, —Ç–∞–∫ –∫–∞–∫ –ø–æ—Ä—Ç —Ç–µ–ø–µ—Ä—å —è–≤–ª—è–µ—Ç—Å—è –æ–±—â–∏–º –¥–ª—è –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤ —Å–µ—Ç–∏ —Ö–æ—Å—Ç–∞.
3. None network : –≤ —Å–µ—Ç–∏ —Ç–∞–∫–æ–≥–æ —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω—ã –Ω–∏ –∫ –æ–¥–Ω–æ–π —Å–µ—Ç–∏ –∏ –Ω–µ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –≤–Ω–µ—à–Ω–µ–π —Å–µ—Ç–∏ –∏–ª–∏ –¥—Ä—É–≥–∏–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º. –ò—Ç–∞–∫, —ç—Ç–∞ —Å–µ—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å —Å–µ—Ç–µ–≤–æ–π —Å—Ç–µ–∫ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.
4. Overlay network : –°–æ–∑–¥–∞–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —á–∞—Å—Ç–Ω—É—é —Å–µ—Ç—å, –∫–æ—Ç–æ—Ä–∞—è –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —É–∑–ª—ã, —É—á–∞—Å—Ç–≤—É—é—â–∏–µ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ swarm. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –æ–≤–µ—Ä–ª–µ–π–Ω—ã–µ —Å–µ—Ç–∏ –æ–±–ª–µ–≥—á–∞—é—Ç –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–æ–º Docker Swarm –∏ –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º –∏–ª–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö –¥–µ–º–æ–Ω–∞—Ö Docker.
5. Macvlan network : –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –æ—Å–æ–±–µ–Ω–Ω–æ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—â–∏–µ —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫, –æ–∂–∏–¥–∞—é—Ç –ø—Ä—è–º–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —Å–µ—Ç–∏. –í —Ç–∞–∫–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–µ—Ç–µ–≤–æ–π –¥—Ä–∞–π–≤–µ—Ä Macvlan –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è MAC-–∞–¥—Ä–µ—Å–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–º—É —Å–µ—Ç–µ–≤–æ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –∫–∞–∂–¥–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –µ–≥–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–º —Å–µ—Ç–µ–≤—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º, –Ω–∞–ø—Ä—è–º—É—é –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º –∫ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–π —Å–µ—Ç–∏.

[üê≥ –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —Å–µ—Ç–µ–π –≤ Docker ‚Äì IT is good](https://itisgood.ru/2019/10/29/objasnenie-koncepcii-setej-v-docker/)

---
## –ó–∞—á–µ–º –Ω—É–∂–µ–Ω docker-compose?
–í —Å–æ—Å—Ç–∞–≤–µ Docker –µ—Å—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –±–æ–ª—å—à–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–æ–≤: Docker Compose. –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ YAML-—Ñ–∞–π–ª–∞. –ö–æ–º–∞–Ω–¥–∞ docker‚Äëcompose up —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –∏ —Å–æ–∑–¥–∞–µ—Ç –∏–∑ –æ–±—Ä–∞–∑–∞ –Ω–æ–≤—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –∞ —Ç–∞–∫–∂–µ —Å–µ—Ç–∏, —Ç–æ–º–∞ –∏ –≤—Å–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–µ Docker Compose.

–ù–∞ —ç—Ç–∞–ø–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã, –∞ –ø–æ—Ç–æ–º —É–Ω–∏—á—Ç–æ–∂–∞—Ç—å –∏—Ö. Docker Compose –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞—Ç—å –∏ —É–Ω–∏—á—Ç–æ–∂–∏—Ç—å —Å—Ä–µ–¥—É –ø—É—Ç–µ–º –≤–≤–æ–¥–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–º–∞–Ω–¥. –ö —É—á–∞—Å—Ç–∏—é –≤ –ø—Ä–æ–µ–∫—Ç–µ –º–æ–∂–Ω–æ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç—å –∏ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è
–ö–æ–≥–¥–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ, –∏–º–∏ —Ç—Ä—É–¥–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å. –ù–∞ –ø–æ–º–æ—â—å –ø—Ä–∏—Ö–æ–¥—è—Ç —Å–∏—Å—Ç–µ–º—ã –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏.

### Docker Swarm
–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö –∑–∞–¥–∞—á. –ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ —Å–æ–∑–¥–∞—Ç—å –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ö–æ—Å—Ç–æ–≤ —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Ç–µ—Ä Swarm, —Å—á–∏—Ç–∞—è –≤—Å–µ –∫–ª–∞—Å—Ç–µ—Ä–Ω—ã–µ —Ö–æ—Å—Ç—ã –µ–¥–∏–Ω—ã–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ–º. –í Docker-–∫–ª–∞—Å—Ç–µ—Ä–µ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∫–∞–∫ –º–∏–Ω–∏–º—É–º –æ–¥–Ω–∞ —É–ø—Ä–∞–≤–ª—è—é—â–∞—è –Ω–æ–¥–∞ (manager).

### Kubernetes
–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ –Ω–∞ Ubuntu, CentOS –∏ –¥—Ä—É–≥–∏—Ö –û–° Linux. –ü–æ–∑–≤–æ–ª—è–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É, –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –∏–∑ —Å–æ—Ç–µ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ. Kubernetes –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –±–æ–ª—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å–æ Swarm, –Ω–æ –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –µ–≥–æ —Å–ª–æ–∂–Ω–µ–µ.¬ª

- RabbitMQ - [–•–∞–±—Ä](https://habr.com/ru/post/149694/)
- Docker - [–•–∞–±—Ä](https://habr.com/ru/company/ruvds/blog/438796/)




========================
dockerfile
```yaml
FROM python:3.10

WORKDIR /app

COPY requirements.txt .

RUN pip install -r requirements.txt --no-cache-dir

COPY . .

EXPOSE 8000

CMD ["python", "manage.py", "runserver", "0.0.0.0:8000"]

```

docker build --tag python-django .
docker run --publish 8000:8000 python-django


----

docker run -it --rm --name redis -p 6379:6379 redis
–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç Redis –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ Docker. –û–ø—Ü–∏—è -it —Å–æ–æ–±—â–∞–µ—Ç Docker, —á—Ç–æ –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –ø—Ä—è–º–æ –≤–Ω—É—Ç—Ä—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≤–≤–æ–¥–∞. –ü–∞—Ä–∞–º–µ—Ç—Ä --rm —Å–æ–æ–±—â–∞–µ—Ç Docker, —á—Ç–æ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –Ω—É–∂–Ω–æ –æ—á–∏—â–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∏ —É–¥–∞–ª—è—Ç—å —Ñ–∞–π–ª–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. –û–ø—Ü–∏—è --name –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É –∏–º–µ–Ω–∏. –û–ø—Ü–∏—è -p –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –ø–æ—Ä—Ç–∞ 6379, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç Redis, –Ω–∞ —Ç–æ—Ç –∂–µ –ø–æ—Ä—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —Ö–æ—Å—Ç–∞. –í Redis –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ—Ä—Ç 6379.

---
## –î–µ–ø–ª–æ–π –î–∏–ø–ª–æ–º–∞ 
cd frontend  # –í –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ frontend...
docker build -t kireev20000/kittygram_frontend .

cd ../backend  # –¢–æ –∂–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ backend‚Ä¶
docker build -t kireev20000/kittygram_backend .

cd ../gateway  # ...—Ç–æ –∂–µ –∏ –≤ gateway.
docker build -t kireev20000/kittygram_gateway .

docker push kireev20000/kittygram_frontend
docker push kireev20000/kittygram_backend
docker push kireev20000/kittygram_gateway

docker compose -f docker-compose.production.yml up

docker compose -f docker-compose.production.yml exec backend python manage.py collectstatic
docker compose -f docker-compose.production.yml exec backend cp -r /app/static_backend/. /backend_static/static/

sudo systemctl stop gunicorn-kittygram.service
sudo rm /etc/systemd/system/gunicorn-kittygram.service

scp -i yc-kireev20000 docker-compose.production.yml yc-user@158.160.68.229:/home/yc-user/kittygram/docker-compose.production.yml
scp -i yc-kireev20000 .env yc-user@158.160.68.229:/home/yc-user/kittygram/.env

sudo docker compose -f docker-compose.production.yml exec backend python manage.py migrate
sudo docker compose -f docker-compose.production.yml exec backend python manage.py collectstatic
sudo docker compose -f docker-compose.production.yml exec backend cp -r /app/static_backend/. /backend_static/static/

sudo nano /etc/nginx/sites-enabled/default
sudo nginx -t
sudo service nginx reload

sudo journalctl --vacuum-size=1M
docker system prune
df -h

npm cache clean
sudo apt-get clean
docker system prune -a 
journalctl --vacuum-size=100M 
journalctl --vacuum-time=1d 
journalctl --vacuum-files=10

npm cache clean –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∫–ª—é—á–∞ --force


–ê –∫—Ç–æ –∫–∞–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∑–∞–∫–∏–¥—ã–≤–∞–ª docker-compose.yml –∏ nginx —Ñ–∞–π–ª—ã, —è –≤–æ—Ç –≤—Ä—É—á–Ω—É—é —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª, –Ω–µ –º–æ–≥—É –Ω–∞–π—Ç–∏ –∫–æ–º–∞–Ω–¥—É –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å —á–µ—Ä–µ–∑ workflow, –≤—Ä–æ–¥–µ –¥–µ–ª–∞–ª–∏ –∫–∞–∫ —Ç–æ?
uses: appleboy/scp-action@master
        with:
          host: ${{ secrets.HOST }}
          username: ${{ secrets.USER }}
          key: ${{ secrets.SSH_KEY }}
          passphrase: ${{ secrets.SSH_PASSPHRASE }}
          source: "infra/docker-compose.production.yml,infra/nginx.conf"
          target: "foodgram/"
          strip_components: 1
          
          
docker compose -f –∏–º—è_—Ñ–∞–π–ª–∞_–∫–æ–º–ø–æ–∑–∞ up




